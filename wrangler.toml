name = "ohio-beer-path"
main = "src/index.ts"
compatibility_date = "2024-11-24"
compatibility_flags = ["nodejs_compat"]

[observability]
enabled = true

# D1 Database binding
[[d1_databases]]
binding = "DB"
database_name = "ohio-beer-path-db"
database_id = "707e2a1f-3415-43e0-bd68-4de1bb89a66b"

# R2 bucket for images
[[r2_buckets]]
binding = "IMAGES"
bucket_name = "ohio-beer-path-images"

# KV namespace for caching
[[kv_namespaces]]
binding = "CACHE"
id = "276245328e284f3e8dbc4aba8355d12a"

# KV namespace for sessions (needs to be created: wrangler kv:namespace create SESSIONS)
[[kv_namespaces]]
binding = "SESSIONS"
id = "SESSIONS_KV_ID_PLACEHOLDER"

# Workers AI binding
[ai]
binding = "AI"

# Vectorize for semantic search
[[vectorize]]
binding = "VECTORIZE"
index_name = "brewery-embeddings"

# Cron trigger for batch AI processing (3 AM UTC daily)
[triggers]
crons = ["0 3 * * *"]

# Custom domain routes for brewerytrip.com
[[routes]]
pattern = "brewerytrip.com/*"
zone_name = "brewerytrip.com"

[[routes]]
pattern = "*.brewerytrip.com/*"
zone_name = "brewerytrip.com"

# Environment variables
[vars]
ENVIRONMENT = "production"
ADMIN_USER = "admin"
ADMIN_PASS = "ohiobeer2024"

# Secrets (set via wrangler secret put)
# GOOGLE_MAPS_API_KEY
# UNTAPPD_CLIENT_ID - Get from https://untappd.com/api/dashboard
# UNTAPPD_CLIENT_SECRET - Get from https://untappd.com/api/dashboard
# UNTAPPD_REDIRECT_URI - Set to https://brewerytrip.com/api/auth/untappd/callback
#
# To set Untappd secrets:
# wrangler secret put UNTAPPD_CLIENT_ID
# wrangler secret put UNTAPPD_CLIENT_SECRET
# wrangler secret put UNTAPPD_REDIRECT_URI
#
# Note: ADMIN_PASS should be moved to secrets for production:
# wrangler secret put ADMIN_PASS
